package com.javing.html;

import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.net.MalformedURLException;
import java.util.List;

import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;
import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlAnchor;
import com.gargoylesoftware.htmlunit.html.HtmlPage;

/**
 * test crawl 
 * @author Administrator
 *
 */
public class GetAnchor {

	private static final String URL = "http://central.maven.org/maven2/";
	
	private static int i = 0;
	
	public static void main(String[] args) {
		try {
			WebClient client = new WebClient();
			HtmlPage page = client.getPage(URL);
			client.close();
			getPage(page);
		} catch (FailingHttpStatusCodeException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (MalformedURLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public static void getPage(HtmlPage page){
		if(i > 100)
			return;
		try {
			String xml = page.asXml();
			String fileName = String.valueOf(i++);
			BufferedWriter writer = new BufferedWriter(new FileWriter("/mvn/" + fileName));
			writer.write(xml);
			writer.flush();
			writer.close();
			List<HtmlAnchor> as = page.getByXPath("//a[position() > 1]");
			for (HtmlAnchor a : as){
				HtmlPage page2 = a.click(); // why no page2 
			}
		} catch (FailingHttpStatusCodeException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (MalformedURLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
